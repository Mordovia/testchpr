<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="viewport" content="width=device-width,user-scalable=no" />
        <title>Чайный Прогноз</title>
    </head>
    <body>
       <script src="https://vk.com/js/api/xd_connection.js?2"  type="text/javascript"></script>
       <script type="text/javascript"> 
var user = {
name : 'none',
avatar : '',
loaded : false
};
var group = {
 groupname: 'none',
 loaded : false
};
           
  var getUserName = function () {//описываем функцию, которая обращается к API
  VK.api('users.get', {"fields" : "photo_50"}, function (data) {//метод users.get - это тоже функция, которая выводит что-то, обращаясь к АПИ %(
console.log(data);
user['name'] = data.response[0].first_name;//обратились к ВК API - получили ответ, который записали в параметр name переменной user
user['avatar'] = data.response[0].photo_50;//обратились к ВК API - получили ответ, который записали в параметр avatar переменной user

 document.avatar.src = user['avatar'] //определили картинку с именем avatar и ссылкой из ВК Апи, которую потом выводим в HTML по имени
// document.write ("Привет, " + user['name']);
}),
 VK.api('groups.getById', {'group_ids': '121807904', 'fields' : 'photo_50'}, function (data) {
	group['groupname'] = data.response[0].name;
//	group['group_avatar'] = data.response[0].photo_50;
	user['loaded'] = true;
document.getElementById('hello').innerHTML='Привет, '+ user['name'] + ', хочешь получить чайный прогноз от ' + group['groupname'] + '?';//ищем в html-коде кусок с тегом "hello", после чего записываем в него текст 
   	})
  };
//function clearDiv() {//функция очистки дива (точнее, двух дивов) в одном диве под одним id объединил 2 кнопки
//	document.getElementById('button').innerHTML = '';
//	document.getElementById('hello').innerHTML = '';
//	document.getElementById('prognoz').innerHTML = 'Твой чайный прогноз:';
	function drawTable() {
		var element = document.createElement('table');
		element.setAttribute('border', '1');
		element.setAttribute('id', 'tab');
		element.addEventListener('click', onClickCell, false);
		for (var i=0; i<2; i++){
			var row = element.insertRow(i);
			for(var j=0; j<3; j++){
				var cell = row.insertCell(j);
				cell.width = "100";
				cell.height = "100";
				cell['id'] = "".concat(i,j);
			}
		}
		document.body.appendChild(element);
	}
	function onClickCell(event){
    	alert(event.target.id);
	}
//}
function exit() {//функция выхода - перебрасывает на главную страницу ВК
		    parent.window.location.href = 'http://vk.com/';
}
		    
var status = false;
VK.init(function() { //с этого мы начинаем работу с ВКонтакте API
      status = true; //меняем состояние переменной
      getUserName();//это наша функция, которая обращается к API
console.log('VK is inited'); 
  }, function() { //если произошла ошибка инициализации
     console.log('error'); 
}, '5.63'); //версия API
</script>
<img name = 'avatar' src = "" />
<div id='hello'></div>
<p>
   <div id='button'><center><form>
 <input type = 'button' value = 'Да' onClick = 'drawTable()' /> <!-- кнопка с очисткой дива, точнее двух дивов -->
</form></center><p>
   	<div name='exit'>  <center><form>
 <input type = 'button' value = 'Нет/Выход' onClick = 'exit()' /> <!-- кнопка для выхода -->
</form></center>
	</div>
   </div>
<div id='prognoz' align=center>
	<div id='table'>
	</div>
</div>
</body>
</html>
